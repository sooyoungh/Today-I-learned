## Javaì˜ Singleton íŒ¨í„´


**ëª©ì°¨**
1. [Singleton íŒ¨í„´ì´ë€](#singleton-íŒ¨í„´ì´ë€)
2. [Singleton íŒ¨í„´ ì‚¬ìš©í•˜ëŠ” ì´ìœ ](#singleton-íŒ¨í„´-ì‚¬ìš©í•˜ëŠ”-ì´ìœ )
1. [Singleton íŒ¨í„´ ì˜ˆì‹œ](#singleton-íŒ¨í„´-ì˜ˆì‹œ)
4. [Singleton íŒ¨í„´ì˜ ë¬¸ì œì ](#singleton-íŒ¨í„´ì˜-ë¬¸ì œì )
5. [ë©€í‹° ìŠ¤ë ˆë”© ë¬¸ì œ í•´ê²°ë°©ë²•](#ë©€í‹°-ìŠ¤ë ˆë”©-ë¬¸ì œ-í•´ê²°ë°©ë²•)


## Singleton íŒ¨í„´ì´ë€

<aside>
  
    ğŸ’¡ ê°ì²´ë¥¼ í•˜ë‚˜ë§Œ ìƒì„± í•˜ë„ë¡ í•˜ë©°, ìƒì„±ëœ ê°ì²´ë¥¼ ì–´ë””ì—ì„œë“ ì§€ ì°¸ì¡°í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” íŒ¨í„´

</aside>

- í´ë˜ìŠ¤ì—ì„œ í•˜ë‚˜ë¿ì¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê´€ë¦¬í•˜ê³ , ì¸ìŠ¤í„´ìŠ¤ë¡œ ì¶”ê°€ë¡œ ë§Œë“¤ì§€ ëª»í•˜ë„ë¡ ë§‰ì•„ì•¼ í•œë‹¤
- ì–´ë””ì—ì„œë“ ì§€ ì°¸ì¡°í•  ìˆ˜ ìˆë„ë¡(ì „ì—­ ì ‘ê·¼ ê°€ëŠ¥) í•´ì•¼í•¨
- ê³µìœ  ê°ì²´ì´ê¸° ë•Œë¬¸ì— ì†ì„±ì„ ê°–ê²Œ ë˜ë©´, ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ ë³€ê²½í•˜ë©´ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤. 
  
=> ì†ì„±ì„ ê°–ì§€ ì•Šê²Œ í•˜ê±°ë‚˜, ì“°ê¸°ê°€ ì•„ë‹Œ ì½ê¸° ì „ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.


## Singleton íŒ¨í„´ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

<aside>
  
    ğŸ’¡ ë©”ëª¨ë¦¬ì— í•œë²ˆë§Œ í• ë‹¹ëœë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

</aside>

- ìµœì´ˆë¡œ ë©”ëª¨ë¦¬ í• ë‹¹ í›„ì—ëŠ” ì´ë¯¸ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í™œìš©í•˜ì—¬, ë©”ëª¨ë¦¬/ì†ë„ ì¸¡ë©´ì—ì„œ íš¨ìœ¨ì ì´ë‹¤.
- ë˜í•œ ë°ì´í„° ê³µìœ ê°€ ì‰½ë‹¤. (ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ì „ì—­ì—ì„œ ì ‘ê·¼ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì—) ë‹¤ë§Œ, ë™ì‹œì„± ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.



## Singleton íŒ¨í„´ ì˜ˆì‹œ

ì‹±ê¸€í„´ íŒ¨í„´ì„ êµ¬í˜„í•˜ë ¤ë©´ ë‹¤ìŒ 3ê°€ì§€ê°€ í•„ìš”í•˜ë‹¤.

1. ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ (static ì°¸ì¡° ë³€ìˆ˜ë¡œ ì •ì˜ë˜ì–´ì•¼ í•¨)
2. private ì ‘ê·¼ ì œì–´ìê°€ ì§€ì •ëœ ìƒì„±ì (ì™¸ë¶€ì—ì„œ newë¡œ ê°ì²´ ìƒì„±í•  ìˆ˜ ì—†ë„ë¡)
3. ì™¸ë¶€ì— ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•˜ëŠ” ë©”ì†Œë“œ (staticìœ¼ë¡œ ì •ì˜)


```java
public class Printer {

  static Printer printer; // 1) ì •ì  ì°¸ì¡° ë³€ìˆ˜

  private Printer() { }         // 2) privateìœ¼ë¡œ ìƒì„± (Printer ìƒì„±ìë¥¼ ì™¸ë¶€ì—ì„œ ì‚¬ìš© ë¶ˆê°€)

    public static Printer getPrinter(){   // 3) ê°ì²´ ë°˜í™˜ ë©”ì†Œë“œ (ì–´ë””ì„œë“  ì™¸ë¶€ì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë„ë¡!)
    if (printer == null) {
      printer = new Printer();
    }
    return printer;
  }
}
```

## Singleton íŒ¨í„´ì˜ ë¬¸ì œì 

- ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ë™ê¸°í™” ì²˜ë¦¬ë¥¼ í•˜ì§€ ì•Šì•˜ì„ ë•Œ, ì¸ìŠ¤í„´ìŠ¤ê°€ 2ê°œê°€ ìƒì„±ë˜ëŠ” ë¬¸ì œë„ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
- í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë µë‹¤ â†’ ìì›ì„ ê³µìœ í•˜ê³  ìˆê¸°ì— í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ë ¤ë©´ ë§¤ë²ˆ ì¸ìŠ¤í„´ìŠ¤ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•´ì£¼ì–´ì•¼ í•œë‹¤.
- í´ë¼ì´ì–¸íŠ¸ê°€ êµ¬ì²´ì ì¸ í´ë˜ìŠ¤ì— ì˜ì¡´í•˜ê²Œ ëœë‹¤. â†’ SOLID ì›ì¹™ ì¤‘ DIPë¥¼ ìœ„ë°˜

>  ë‹¤ì¤‘ ìŠ¤ë ˆë“œì—ì„œëŠ” ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ì— ë™ì‹œì— ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ì ‘ê·¼í•˜ëŠ” Race Condition ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
(Race Condition : ë©”ëª¨ë¦¬ì™€ ê°™ì€ ë™ì¼í•œ ìì›ì„ 2ê°œ ì´ìƒì˜ ìŠ¤ë ˆë“œê°€ ì´ìš©í•˜ë ¤ê³  ê²½í•©í•˜ëŠ” í˜„ìƒ)
> 
> => ë©€í‹°ìŠ¤ë ˆë”© í™˜ê²½ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë™ì‹œì„± ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ syncronized í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

## ë©€í‹° ìŠ¤ë ˆë”© ë¬¸ì œ í•´ê²°ë°©ë²•

1. ì •ì  ë³€ìˆ˜ì— ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ ë°”ë¡œ ì´ˆê¸°í™”í•˜ëŠ” ë°©ë²• (Eager Initialization)
    - ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ë™ê¸°í™” ì²˜ë¦¬ë¥¼ í•˜ì§€ ì•Šì•˜ì„ ë•Œ, ì¸ìŠ¤í„´ìŠ¤ê°€ 2ê°œê°€ ìƒì„±ë˜ëŠ” ë¬¸ì œë„ ë°œìƒí•  ìˆ˜ ìˆëŠ”ë°, ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•
    - ì¸ìŠ¤í„´ìŠ¤ê°€ í•„ìš”í•  ë•Œ ìƒì„±í•˜ì§€ ë§ê³  ì²˜ìŒë¶€í„° ë§Œë“œëŠ” ë°©ë²•
    - ì–´í”Œë¦¬í…Œì´ì…˜ ì‹¤í–‰ ì¤‘ì— ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ì§€ ì•Šê³  JVMì—ì„œ í´ë˜ìŠ¤ ë¡œë”©ë  ë•Œ ìƒì„±
    - ```java
      public class Printer {
      
        // static ë³€ìˆ˜ì— ì™¸ë¶€ì— ì œê³µí•  ìê¸° ìì‹ ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ ì´ˆê¸°í™”
        private static Printer printer = new Printer();
        
        private Printer() { }
        
        // ìê¸° ìì‹ ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì™¸ë¶€ì— ì œê³µ
        public static Printer getPrinter(){
           return printer;
        }
        
        public void print(String str) {
          System.out.println(str);
        }
      }
      ```
    
    
    
2. ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“œëŠ” ë©”ì„œë“œì— ë™ê¸°í™”í•˜ëŠ” ë°©ë²• (Thread-Safe Initialization)
    - `synchronized` í‚¤ì›Œë“œë¥¼ í™œìš©í•˜ì—¬ ë™ê¸°í™”í•˜ê¸°! â†’ getInstance()ì— Lockì„ í•˜ëŠ” ë°©ì‹ì´ë¼ ì†ë„ê°€ ëŠë¦¬ë‹¤.
    
    - ```java
      public class Printer {
      
         // ì™¸ë¶€ì— ì œê³µí•  ìê¸° ìì‹ ì˜ ì¸ìŠ¤í„´ìŠ¤
        private static Printer printer = null;
        
        private int counter = 0;
        
        private Printer() { }
        
        // ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“œëŠ” ë©”ì„œë“œ ë™ê¸°í™” (ì„ê³„ êµ¬ì—­)
        public synchronized static Printer getPrinter(){
          if (printer == null) {
            printer = new Printer(); // Printer ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
          }
          return printer;
        }
        
        public void print(String str) {
          // ì˜¤ì§ í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ì ‘ê·¼ì„ í—ˆìš©í•¨ (ì„ê³„ êµ¬ì—­)
          // ì„±ëŠ¥ì„ ìœ„í•´ í•„ìš”í•œ ë¶€ë¶„ë§Œì„ ì„ê³„ êµ¬ì—­ìœ¼ë¡œ ì„¤ì •í•œë‹¤.
          synchronized(this) {
            counter++;
            System.out.println(str + counter);
          }
        }
      }
      ```
    

**Reference**

- [https://tecoble.techcourse.co.kr/post/2020-11-07-singleton/](https://tecoble.techcourse.co.kr/post/2020-11-07-singleton/)
- [https://gmlwjd9405.github.io/2018/07/06/singleton-pattern.html](https://gmlwjd9405.github.io/2018/07/06/singleton-pattern.html)



[ìœ„ë¡œê°€ê¸°â¬†](#javaì˜-singleton-íŒ¨í„´)
