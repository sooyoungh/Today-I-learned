# 3. I/O ëŒ€ì‹  NIO?

**ëª©ì°¨**

* [NIO ë™ì‘ ê³¼ì •](nio.md#nio-ë™ì‘-ê³¼ì •)
* [1. NIOëŠ” ì±„ë„/ë²„í¼ ê¸°ë°˜ì´ë‹¤.](nio.md#1-nioëŠ”-ì±„ë„ë²„í¼-ê¸°ë°˜ì´ë‹¤)
* [2. NIOëŠ” ë¹„ë™ê¸°, Non-blockingì´ ê°€ëŠ¥í•˜ë‹¤.](nio.md#2-nioëŠ”-ë¹„ë™ê¸°-non-blockingì´-ê°€ëŠ¥í•˜ë‹¤)
* [NIOì—ì„œ ê°œì„ í•œ ì ](nio.md#nioì—ì„œ-ê°œì„ í•œ-ì )
* [ê·¸ëŸ¼ í•­ìƒ NIOê°€ ë” ì¢‹ì„ê¹Œ?](nio.md#ê·¸ëŸ¼-í•­ìƒ-nioê°€-ë”-ì¢‹ì„ê¹Œ)
* [ì •ë¦¬í•˜ë©´](nio.md#ì •ë¦¬í•˜ë©´)

> IOëŠ” ìŠ¤íŠ¸ë¦¼ ê¸°ë°˜, ë™ê¸°/ë¸”ë¡œí‚¹ ë°©ì‹ë§Œ ì§€ì›í•œë‹¤. ë•Œë¬¸ì— ì†ë„ê°€ ëŠë¦¬ê³  ì…ë ¥/ì¶œë ¥ìŠ¤íŠ¸ë¦¼ì„ ë”°ë¡œ ë§Œë“¤ì–´ì£¼ì–´ì•¼ í•˜ëŠ” ë“±ì˜ ë‹¨ì ì´ ìˆë‹¤. ì´ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ ë“±ì¥í•œ NIOë¥¼ ì•Œì•„ë³´ì. ê·¸ë¦¬ê³  ê°ê° ì–´ë–¤ ìƒí™©ì— ì‚¬ìš©í•˜ë©´ ì¢‹ì„ ì§€ë„ ì•Œì•„ë³´ìâ•

## NIO ë™ì‘ ê³¼ì •

ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•˜ê²Œ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì§€ë§Œ ì‚´í´ë³´ì•˜ë‹¤. (ìì„¸í•œ ê±´ ë‹¤ìŒ í¬ìŠ¤íŒ…..)

![image](https://user-images.githubusercontent.com/77563814/186948835-3a4bab52-1b3d-4311-a412-dbd9039c42b7.png)

ì¼ë‹¨ NIOëŠ” **Selector**/**Channel**/**Buffer**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì…ì¶œë ¥ ì²˜ë¦¬ë¥¼ í•œë‹¤. ê°ê°ì˜ ì—­í• ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

* **Channel** : ë°ì´í„°ë¥¼ ì½ê³  ì“°ëŠ” í†µë¡œì´ë‹¤. IOì˜ `stream`ì—­í• ì„ í•˜ëŠ” NIOì˜ ì…ì¶œë ¥ í´ë˜ìŠ¤ì´ë‹¤.
  * ì±„ë„ì€ í•­ìƒ ë²„í¼ì—ì„œë¶€í„° ì½ê±°ë‚˜ ë²„í¼ë¡œ ì“´ë‹¤.
* **Buffer** : ì…ì¶œë ¥ ë°ì´í„°ë¥¼ ì„ì‹œ ì €ì¥í•˜ëŠ” í´ë˜ìŠ¤ì´ë‹¤.
* **Selector** : í•œ ìŠ¤ë ˆë“œì—ì„œ ì—¬ëŸ¬ ì±„ë„ì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ê°ì²´(ë©€í‹°í”Œë ‰ì„œ). ì—¬ëŸ¬ ì±„ë„ì—ì„œì˜ ì´ë²¤íŠ¸ë“¤ì„ ëª¨ë‹ˆí„°ë§í•œë‹¤.

NIOëŠ” Selector/Channel/Bufferë¥¼ ì‚¬ìš©í•˜ì—¬ I/Oì˜ ë‹¨ì ì„ ê°œì„ í•˜ì˜€ë‹¤. ìì„¸íˆ ì•Œì•„ë³´ì.

## 1. NIOëŠ” ì±„ë„/ë²„í¼ ê¸°ë°˜ì´ë‹¤.

NIOëŠ” ì±„ë„/ë²„í¼ë¡œ I/O ìŠ¤íŠ¸ë¦¼ì˜ ë‹¨ì ì„ ê·¹ë³µí•˜ì˜€ë‹¤.

*   `Channel`ë¡œ ì–‘ë°©í–¥ IO í†µì‹ ì„ í•  ìˆ˜ ìˆë‹¤.

    ì¦‰, ë”°ë¡œ ì…ë ¥/ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì„ ë§Œë“¤ì–´ì£¼ëŠ” IOì™€ ë‹¤ë¥´ê²Œ í•˜ë‚˜ì˜ ì±„ë„ë¡œ ì…ì¶œë ¥ì´ ê°€ëŠ¥í•˜ë‹¤.
*   `Buffer`ì— ì…ì¶œë ¥ ë°ì´í„°ë¥¼ ì„ì‹œ ì €ì¥í•œë‹¤.

    `Channel`ì€ ì½ì€ ë°ì´í„°ë¥¼ ë¬´ì¡°ê±´ ë‚´ë¶€ì˜ `Buffer`ì— ì €ì¥í•œë‹¤. ìŠ¤íŠ¸ë¦¼ê³¼ ë‹¤ë¥´ê²Œ `Buffer`ì—ì„œ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì½ê³  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
*   `Direct Buffer`ë¥¼ ì‚¬ìš©í•  ê²½ìš° ë” ë¹ ë¥´ë‹¤.

    I/Oì˜ ìŠ¤íŠ¸ë¦¼ì—ë„ ë²„í¼ê°€ ìˆë‹¤. í•˜ì§€ë§Œ ìŠ¤íŠ¸ë¦¼ì˜ ë²„í¼ëŠ” JVM ë²„í¼ì´ë‹¤. ì»¤ë„ ë²„í¼ì— ì§ì ‘ ì ‘ê·¼í•˜ì§€ ì•Šê³  JVMì˜ ë²„í¼ë¥¼ ê±°ì¹˜ë¯€ë¡œ ì†ë„ê°€ ëŠë ¸ë‹¤. í•˜ì§€ë§Œ NIOì˜ `Direct Buffer`ëŠ” ì»¤ë„ ë²„í¼ì— ì§ì ‘ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë” ë¹ ë¥´ë‹¤.

> **Direct Buffer VS Non-Direct Buffer**
>
> I/Oì—ì„œë„ ë²„í¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, ë™ì‘ ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. [ì´ë¯¸ì§€ ì¶œì²˜](https://howtodoinjava.com/java/io/how-java-io-works-internally/)
>
> <img src="https://user-images.githubusercontent.com/77563814/187010534-747a1ab2-49f1-4119-87dd-798fb1a50a1e.png" alt="image" data-size="original">
>
> 1. disk controllerê°€ **diskë¡œë¶€í„° ë°ì´í„°ë¥¼ fetchí•´ì˜¨ë‹¤.**
> 2. disk controllerëŠ” ì½ì–´ì˜¨ ë°ì´í„°ë¥¼ kernel memory bufferì— writeí•œë‹¤. (DMA=CPU ì—†ì´ ë©”ì¸ë©”ëª¨ë¦¬ ì ‘ê·¼)
> 3. (ë²„í¼ê°€ ìš©ëŸ‰ì´ ì°¨ê³ , read ìš”ì²­ì´ ì˜¤ë©´) kernelì€ buffer ë°ì´í„°ë¥¼ processì˜ bufferë¡œ ë³µì‚¬í•œë‹¤.
>
> ì¦‰, I/Oì˜ ë²„í¼ ë™ì‘ê³¼ì •ì€ ì»¤ë„ ë©”ëª¨ë¦¬ë¥¼ ì§ì ‘ ì ‘ê·¼í•˜ì§€ ì•Šê³  JVM ë²„í¼ì— ë³µì‚¬í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. ì´ ë•Œë¬¸ì— ì†ë„ê°€ ëŠë ¤ì§„ë‹¤. NIOì—ì„œëŠ” ì´ë¥¼ ê°œì„ í•˜ì—¬ ì»¤ë„ ë©”ëª¨ë¦¬ ë²„í¼ë¥¼ ì‚¬ìš©í•œ> ë‹¤. JVM ë²„í¼ë¥¼ ê±°ì¹˜ì§€ ì•Šê³ , ì§ì ‘ DMAí•œë‹¤. ì´ë¥¼ **Direct Buffer**ë¼ í•œë‹¤.
>
> Direct BufferëŠ” C í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼í•˜ëŠ” ë“± ë²„í¼ ìƒì„± ì‹œê°„ì€ ì˜¤ë˜ ê±¸ë¦°ë‹¤(ëŒ€ìš©ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì„ ê²½ìš° ë¶ˆë¦¬). ê·¸ëŸ¬ë‚˜ ì…ì¶œë ¥ì´ ë¹ ë¥´ê³  ë²„í¼ì˜ í¬ê¸°ê°€ í¬ë‹¤. ë”°ë¼ì„œ í•œë²ˆ ë²„í¼ ìƒì„± í›„ ì¬ì‚¬ìš©í•˜ê¸° ì í•©í•˜ë‹¤. Non-Direct BufferëŠ” JVMì˜ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ë²„í¼ì˜ í¬ê¸°ê°€ í¬ì§€ ì•Šê³  ë²„í¼ ìƒì„±ì´ ë¹ ë¥´ë‹¤. ê·¸ëŸ¬ë‚˜ ì…ì¶œë ¥ ì†ë„ê°€ ëŠë¦¬ë‹¤.

## 2. NIOëŠ” ë¹„ë™ê¸°, **Non-blockingì´ ê°€ëŠ¥í•˜ë‹¤.**

*   `Selector`ë¥¼ í†µí•´ í•œ ìŠ¤ë ˆë“œì—ì„œ **Non-blocking**ìœ¼ë¡œ ì—¬ëŸ¬ ì±„ë„ì„ ê´€ë¦¬í•œë‹¤.

    ì…€ë ‰í„°ëŠ” ì—¬ëŸ¬ ì±„ë„ì—ì„œì˜ ì´ë²¤íŠ¸ë¥¼ ëª¨ë‹ˆí„°ë§í•œë‹¤. ì…ì¶œë ¥ ì‘ì—…ì´ ì¤€ë¹„ê°€ ë˜ë©´ ì±„ë„ë§Œ ì„ íƒí•´ì„œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì…ì¶œë ¥ ì‘ì—…ì‹œ ìŠ¤ë ˆë“œê°€ ë©ˆì¶”ì§€ ì•ŠëŠ”ë‹¤. â‡’ ì•ì„  í¬ìŠ¤íŠ¸ì—ì„œ ë¹„ë™ê¸°/ë…¼ë¸”ë¡œí‚¹ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ë‹¤.

    * ë‹¨, íŒŒì¼ I/OëŠ” Blocking ë°©ì‹ë§Œ ê°€ëŠ¥í•˜ë‹¤. ë„¤íŠ¸ì›Œí‚¹ì˜ ê²½ìš° ë…¼ë¸”ë¡œí‚¹ì„ ì‚¬ìš©í•˜ì—¬ ì„±ëŠ¥ í–¥ìƒí•œë‹¤.

## **NIOì—ì„œ ê°œì„ í•œ ì **

I/Oì˜ ë‹¨ì ì„ ê°œì„ í•œ ì ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. IOëŠ” ìŠ¤íŠ¸ë¦¼ ê¸°ë°˜ì´ë‹¤. â†’ **NIOëŠ” ì±„ë„/ë²„í¼ ê¸°ë°˜ì´ë‹¤.**
   * ì…ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì„ ë”°ë¡œ ë§Œë“¤ì–´ì£¼ì§€ ì•Šì•„ë„ ëœë‹¤.
   * ìºì‹œë˜ì–´ ìˆì–´ ë°ì´í„° ì•ë’¤ë¡œ ì´ë™ ê°€ëŠ¥í•˜ì—¬ ì›í•˜ëŠ” ìœ„ì¹˜ë§Œ ì½ì„ ìˆ˜ ìˆë‹¤.
   * ì»¤ë„ ë²„í¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ ë¹ ë¥´ë‹¤.
2. ë™ê¸°, **Blocking** ë°©ì‹ë§Œ ì§€ì›í•œë‹¤ â†’ **NIOëŠ” ë¹„ë™ê¸°, Non-blockingë„ ê°€ëŠ¥í•˜ë‹¤.**
   * ìŠ¤ë ˆë“œê°€ ì±„ë„ì„ í†µí•´ ìš”ì²­í•˜ê³ , ìŠ¤ë ˆë“œê°€ ë¸”ë¡œí‚¹ ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. Selectorë¡œ ì—¬ëŸ¬ ì±„ë„ì„ ëª¨ë‹ˆí„°ë§í•˜ê¸°ì— ê°€ëŠ¥í•˜ë‹¤.

## ê·¸ëŸ¼ í•­ìƒ NIOê°€ ë” ì¢‹ì„ê¹Œ?

[ì´ëŠ” ë¹„ë™ê¸°/ë…¼ë¸”ë¡œí‚¹ ë°©ì‹ì´ í•­ìƒ ì¢‹ì€ ê°€? ì™€ ê°™ì€ ì§ˆë¬¸ì´ë‹¤.](blocking\_synchronous.md#í•­ìƒ-ë¹„ë™ê¸°--ë…¼ë¸”ë¡œí‚¹ì´-ì¢‹ì„ê¹Œ) ì›¹ì„œë¹„ìŠ¤ì²˜ëŸ¼ ë¶ˆíŠ¹ì • ë‹¤ìˆ˜ì˜ í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ë¼ë©´ ìœ ë¦¬í•˜ë‹¤. ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ì§€ ì•Šê³  ì‹±ê¸€ ìŠ¤ë ˆë“œë¡œ ë¹„ë™ê¸°/ë…¼ë¸”ë¡œí‚¹ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸°ì— íš¨ìœ¨ì ì´ê¸° ë•Œë¬¸ì´ë‹¤.

ê·¸ëŸ¬ë‚˜ NIOëŠ” ëª¨ë“  ì—°ê²° ì‹œ ë²„í¼ë¥¼ í• ë‹¹í•´ì•¼í•˜ê³ , ë²„í¼ í• ë‹¹ ì‹œ ì˜¤ë²„í—¤ë“œê°€ í¬ë‹¤(ì…ì¶œë ¥ì€ ë¹ ë¥´ì§€ë§Œ, ë²„í¼ ìƒì„± ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦°ë‹¤). ë°˜ë©´ IOëŠ” ë²„í¼ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. ë˜í•œ ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ì‘ì—…ì€ ì°¨ë¼ë¦¬ ìŠ¤ë ˆë“œì˜ ìˆ˜ë¥¼ ëŠ˜ë¦¬ëŠ” ë°©ì‹ì´ ìœ ë¦¬í•˜ë‹¤.

ë”°ë¼ì„œ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•˜ì

```
ğŸŒŸ í´ë¼ì´ì–¸íŠ¸ ìˆ˜ê°€ ë§ê³  + I/O ì‘ì—…ì´ ê¸¸ì§€ ì•Šê³  + ë¹„ë™ê¸°ì ì¸ ì‘ì—… â‡’ NIO

   í´ë¼ì´ì–¸íŠ¸ ìˆ˜ê°€ ì ê³  + ë°ì´í„°ê°€ ëŒ€ìš©ëŸ‰ + ë™ê¸°ì ì¸ ì‘ì—… â‡’ I/O
```

## ì •ë¦¬í•˜ë©´

> I/Oì˜ ë‹¨ì ë“¤ì„ ê°œì„ í•œ NIOê°€ ë“±ì¥í•˜ì˜€ë‹¤. ìŠ¤íŠ¸ë¦¼ì˜ ë‹¨ì ì„ ë³´ì™„í•œ ë°©ì‹ìœ¼ë¡œ, Selector/Channel/Bufferë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì…ì¶œë ¥ ì²˜ë¦¬ë¥¼ í•œë‹¤. ì†ë„/ë¹„ë™ê¸°/Non-blocking ë“±ì˜ ì¥ì ì„ ê°€ì ¸ì„œ I/Oë³´ë‹¤ ìš°ìˆ˜í•˜ë‹¤. ê·¸ëŸ¬ë‚˜ NIOì˜ ë²„í¼ ìƒì„± ê³¼ì •ì˜ ì˜¤ë²„í—¤ë“œê°€ ë” í¬ë¯€ë¡œ í•­ìƒ ìœ ë¦¬í•˜ì§€ëŠ” ì•Šë‹¤.
>
> ëŒ€ìš©ëŸ‰ì˜ ë°ì´í„°ëŠ” IOë¥¼ ì‚¬ìš©í•˜ëŠ” ê²Œ ì¢‹ë‹¤. ë˜í•œ ë™ê¸°ì ì¸ ì‘ì—…ì¼ ê²½ìš°ì—ë„ IOë¡œ ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ì–´ ì²˜ë¦¬í•˜ëŠ” ê²Œ ìœ ë¦¬í•  ìˆ˜ ìˆë‹¤.

**Reference**

* [https://junghyungil.tistory.com/131](https://junghyungil.tistory.com/131)
* [https://jiwondev.tistory.com/262](https://jiwondev.tistory.com/262)
* [https://dev-coco.tistory.com/42](https://dev-coco.tistory.com/42)

[ìœ„ë¡œê°€ê¸°â¬†](nio.md#io-ëŒ€ì‹ -nio)
